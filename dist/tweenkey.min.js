!function(e,t){"function"==typeof define&&define.amd?define([],t):"object"==typeof module&&module.exports?module.exports=e.Tweenkey=t():e.Tweenkey=t()}(this,function(){"use strict";function e(e,t){return function(n){return t?typeof n===e:D.call(n)===e}}function t(e,t){var n=!R.isArray(t),r=e._firstNode;do for(var i=r.properties.length;i--;){var o=r.properties[i];o.enabled&&(n||t.indexOf(o.name)>-1)&&(o.enabled=!1,delete P[o.id])}while(r=r.next)}function n(e){var t=e._firstNode;do for(var n=t.properties.length;n--;){var r=t.properties[n];r.enabled&&(P[r.id]&&P[r.id]!==r&&(P[r.id].enabled=!1,delete P[r.id]),P[r.id]=r)}while(t=t.next)}function r(e){var t=e._firstNode;do for(var n=t.properties.length;n--;)t.properties[n].refresh();while(t=t.next)}function i(e,t,n,r){this.id=e,this.name=t,this.originProperties=n,this.targetProperties=r,this.enabled=!0}function o(e,t){this._initted=!1;var n=t.shift();if("object"!=typeof n)throw"Invalid Tween";return l(this,n,t),this}function a(e){var t=e._firstNode,n=0;do{for(var r=!1,i=t.properties.length;i--;){var o=t.properties[i];o.enabled?(t.target[o.name]=e._ease(e._progress,o.start,o.end-o.start),r=!0):t.properties.splice(i,1)}n+=0|r}while(t=t.next);return n}function s(e,t){var i=t*e._timeScale;if(e._delayLeft>0){var o=R.clamp(i,0,e._delayLeft);e._delayLeft-=o,i-=o}if(0==e._delayLeft){e._syncNextTick&&(e._syncNextTick=!1,r(e),n(e)),e._started||(e._started=!0,e._onStart()),e._elapsedTime+=i*e._direction,e._elapsedTime<0&&(e._elapsedTime=0),e._progress=1,e._duration>0&&(e._progress=C.round(e._elapsedTime/e._duration*1e4)/1e4,e._progress>1&&(e._progress=1),e._progress<0&&(e._progress=0));a(e)>0?e._onUpdate():e.kill()}(1==e._direction&&e._elapsedTime>=e._duration||e._direction==-1&&0==e._elapsedTime)&&e._alive&&(e._repeatLeft>0&&e._repeatLeft--,0==e._repeatLeft?(e._onComplete(),e.kill()):(e._yoyo?e._direction*=-1:e._elapsedTime=0,e._delayLeft=e._repeatDelay,e._onRepeat()))}function u(e,t,n){for(var r,o,a=R.isArray(e._target)?e._target:[e._target],s=a.length;s--;){var u=a[s];u._twkId=u._twkId||Q++,n=n||u;var f=[];for(var c in t)if(!e.hasOwnProperty(c)&&c in u&&R.isNumber(t[c])){var l=new i(u._twkId+c,c,n,t);2!=e._type&&3!=e._type||(l.targetProperties=n,l.originProperties=t),l.refresh(),f.push(l)}var _={target:u,properties:f};o=o||_,r&&(r.next=_),r=_}e._firstNode=o}function f(e){e._queued||(u(e,e._params[0],e._params[1]),I.push(e),e._queued=!0,e._syncNextTick=!0,e._started=!1)}function c(e){if(O[e])return O[e];if(R.isArray(e)&&4==e.length)return L(S.apply(this,e));if(void 0!=e){var t=Object.keys(O).join(" | ");console.warn("Invalid easing name: "+e),console.warn("Available easings: "+t)}return O.linear}function l(e,t,n){var r=n.shift(),i=n.shift(),o=n.shift();R.isObject(r)&&(i=r,r=0);var a=o||i,s=R.isNumber(a.delay)?C.max(0,a.delay):0,u=R.isNumber(a.repeat)?a.repeat:0;e._target=t,e._initted=!0,e._started=!1,e._queued=!1,e._syncNextTick=!0,e._direction=1,e._progress=0,e._elapsedTime=0,e._alive=!0,e._delay=s,e._delayLeft=s,e._repeat=u,e._repeatLeft=u,e._ease=c(a.ease),e._repeatDelay=R.isNumber(a.repeatDelay)?C.max(0,a.repeatDelay):0,e._yoyo=!!R.isBoolean(a.yoyo)&&a.yoyo,e._timeScale=R.isNumber(a.timeScale)&&a.timeScale>0?a.timeScale:1,e._duration=R.isNumber(r)?C.max(0,r):0,e._running=!R.isBoolean(a.autoStart)||a.autoStart,e._onStart=R.isFunction(a.onStart)?a.onStart:R.noop,e._onUpdate=R.isFunction(a.onUpdate)?a.onUpdate:R.noop,e._onComplete=R.isFunction(a.onComplete)?a.onComplete:R.noop,e._onRepeat=R.isFunction(a.onRepeat)?a.onRepeat:R.noop,e._params=[i,o]}function _(e,t,n,r){if(!R.isNumber(t))return!1;var n=!!R.isBoolean(n)&&n,i=n?e._duration+e._delay:e._duration;t=R.clamp(t,0,r?i:1);var o=r?t:t*i;e._elapsedTime=o,n&&o>e._delay&&(e._delayLeft=o-(o-e._delay),e._elapsedTime-=e._delayLeft)}function p(e){return function(){for(var t=I.length;t--;){var n=I[t];n[e].apply(n,arguments)}}}function d(e){for(var t=I.length;t--;)I[t]._alive||(I[t]._queued=!1,I.splice(t,1));for(var t=0,n=I.length;t<n;t++)I[t]._running&&s(I[t],e)}function h(){var e=R.now(),t=!1;k._running&&(k.tick(e),t=!0);for(var n=j.length;n--;){var r=j[n];r._running&&(r.tick(e),t=!0),r._alive||j.splice(n,1)}t&&w(h)}function m(e){var t=new v(e);return j.push(t),t}function v(e){e=e||{},this._onTick=R.isFunction(e.onTick)?e.onTick:R.noop,this._alive=!0,this.setFPS(e.fps),this.resume()}function y(e){e?k.resume():k.pause()}function g(e){e="number"==typeof e?e:k._fpsStep,e<0&&(e=0),!k._running&&d(e)}function b(e){return function(){for(var t=[],n=0;n<arguments.length;++n)t[n]=arguments[n];var r=new o(e,t);return r._initted&&f(r),r}}var w,T,k,S=function(){function e(e,t){return 1-3*t+3*e}function t(e,t){return 3*t-6*e}function n(e){return 3*e}function r(r,i,o){return((e(i,o)*r+t(i,o))*r+n(i))*r}function i(r,i,o){return 3*e(i,o)*r*r+2*t(i,o)*r+n(i)}function o(e,t,n,i,o){var a,s,u=0;do s=t+(n-t)/2,a=r(s,i,o)-e,a>0?n=s:t=s;while(Math.abs(a)>1e-7&&++u<10);return s}function a(e,t,n,o){for(var a=0;a<4;++a){var s=i(t,n,o);if(0===s)return t;t-=(r(t,n,o)-e)/s}return t}var s="function"==typeof Float32Array;return function(e,t,n,u){function f(t){for(var r=0,s=1;10!==s&&c[s]<=t;++s)r+=.1;--s;var u=(t-c[s])/(c[s+1]-c[s]),f=r+.1*u,l=i(f,e,n);return l>=.001?a(t,f,e,n):0===l?f:o(t,r,r+.1,e,n)}if(!(0<=e&&e<=1&&0<=n&&n<=1))throw new Error("bezier x values must be in [0, 1] range");var c=s?new Float32Array(11):new Array(11);if(e!==t||n!==u)for(var l=0;l<11;++l)c[l]=r(.1*l,e,n);return function(i){return e===t&&n===u?i:0===i?0:1===i?1:r(f(i),t,u)}}}(),x=function(e){return function(t){return Math.pow(t,e)}},N=function(e){return function(t){return 1-Math.abs(Math.pow(t-1,e))}},A=function(e){return function(t){return t<.5?x(e)(2*t)/2:N(e)(2*t-1)/2+.5}},L=function(e){return function(t,n,r){return r*e(t)+n}},O={linear:L(A(1)),QuadIn:L(x(2)),QuadOut:L(N(2)),QuadInOut:L(A(2)),CubicIn:L(x(3)),CubicOut:L(N(3)),CubicInOut:L(A(3)),QuartIn:L(x(4)),QuartOut:L(N(4)),QuartInOut:L(A(4)),QuintIn:L(x(5)),QuintOut:L(N(5)),QuintInOut:L(A(5))},F=new function(){},I=[],j=[],P={},Q=1,C=Math,q=window||{},D={}.toString,M=q.performance,R={isFunction:e("function",!0),isObject:e("[object Object]",!1),isArray:Array.isArray||e("[object Array]",!1),isNumber:e("number",!0),isBoolean:e("boolean",!0),isString:e("string",!0),clamp:function(e,t,n){return C.min(C.max(e,t),n)},now:function(){return M&&M.now&&M.now()||+new Date},extend:function(e,t,n){for(var r in t)(n||!(r in e))&&(e[r]=t[r]);return e},noop:function(){return!1}};return i.prototype.refresh=function(){this.start=this.originProperties[this.name],this.end=this.targetProperties[this.name]},o.prototype={delay:function(e){return this._delayLeft=this._delay=e,this},progress:function(e,t){return _(this,e,t,!1),this},time:function(e,t){return _(this,e,t,!0),this},render:function(){n(this),a(this)},restart:function(e,t){return e=void 0!==e&&e,t=void 0===t||t,this._elapsedTime=0,this._progress=0,this._delayLeft=e?this._delay:0,this._alive=!0,this._direction=1,this._started=!1,this.resume(),(t||this._delayLeft>0)&&this.render(),this},reverse:function(){return this._direction*=-1,this},timeScale:function(e){return R.isNumber(e)&&e>0&&(this._timeScale=e),this},kill:function(){if(arguments.length>0){for(var e=[],n=0;n<arguments.length;++n)e[n]=arguments[n];t(this,e)}else this._alive=!1,this._running=!1;return this},pause:function(){return this._running=!1,this},resume:function(){return this._running=!0,f(this),this},toString:function(){return"[object Tween]"}},v.prototype={pause:function(){return this._running=!1,this},resume:function(){return this._then=R.now(),this._running=!0,w(h),this},kill:function(){return this._alive=!1,this},tick:function(e){var t=e-this._then;if(t>this._fpsStep){var n=t%this._fpsStep;this._then=e-n,this._onTick((t-n)/1e3)}return this},setFPS:function(e){this.fps=R.isNumber(e)&&e>0?e:60,this._fpsStep=1e3/this.fps},toString:function(){return"[object Ticker]"}},function(){var e,t,n,r,i,o,a,s,u=0;e=["ms","moz","webkit","o"],t="AnimationFrame",n="request"+t,r="cancel"+t,w=q[n],T=q[r];for(var i=e.lenght;!w&&i--;)w=q[e[i]+"Request"+t],T=q[e[i]+"Cancel"+t];w=w||function(e){return o=R.now(),a=C.max(0,16-(o-u)),s=setTimeout(function(){e(o+a)},a),u=o+a,s},T=T||function(e){clearTimeout(e)}}(),k=new v({onTick:d}),R.extend(F,{set:b(0),to:b(1),from:b(2),fromTo:b(3),killAll:p("kill"),pauseAll:p("pause"),resumeAll:p("resume"),ticker:m,update:g,autoUpdate:y,setFPS:k.setFPS.bind(k)})});