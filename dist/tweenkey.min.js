!function(t,n){"function"==typeof define&&define.amd?define([],n):"object"==typeof module&&module.exports?module.exports=t.Tweenkey=n():t.Tweenkey=n()}(this,function(){"use strict";function t(t,n){return function(r){return n?typeof r===t:N.call(r)===t}}function n(t,n){var r=n||{};t.a=J(r.onStart)?r.onStart:et,t.b=J(r.onUpdate)?r.onUpdate:et,t.c=J(r.onComplete)?r.onComplete:et,t.d=J(r.onRepeat)?r.onRepeat:et}function r(t,n){var r=n||{},e=V(r.delay)?K.max(0,r.delay):0,i=V(r.repeat)?r.repeat:0;t.e=!1,t.f=1,t.g=0,t.h=0,t.i=!0,t.j=e,t.k=e,t.l=!!W(r.yoyo)&&r.yoyo,t.m=t.l?i>0?i:-1:i,t.n=t.m,t.o=V(r.repeatDelay)?K.max(0,r.repeatDelay):0,t.p=V(r.timeScale)&&r.timeScale>0?r.timeScale:1,t.q=!W(r.autoStart)||r.autoStart,t.r=r}function e(t,n){var r=n*t.p;if(t.k>0){var e=nt(r,0,t.k);t.k-=e,r-=e}0==t.k&&(t.h+=r*t.f,t.h=K.max(t.h,0),t.g=1,t.s>0&&(t.g=K.round(t.h/t.s*1e4)/1e4,t.g=nt(t.g,0,1)))}function i(t){(0===t.k&&1==t.f&&t.h>=t.s||t.f==-1&&0==t.h)&&t.i&&(t.n>0&&t.n--,0==t.n?(t.c(t.t||t),t.kill()):(t.l?t.f*=-1:t.h=0,t.k=t.o,t.d(t.t||t)))}function o(t,n,r,e){var i=r?t.s+t.j:t.s;n=nt(n,0,e?i:1);var o=e?n:n*i;t.h=o,t.g=o/i,r&&o>t.j?(t.k=o-(o-t.j),t.h-=t.k):r||(t.k=0)}function u(){setTimeout(function(){Ct=!1,I()},1)}function s(t,n){var r=!Y(n),e=t.u;do{for(var i=e.properties.length;i--;){var o=e.properties[i];o.enabled&&(r||n.indexOf(o.name)>-1)&&(o.enabled=!1,delete Jt[o.id])}}while(e=e.next)}function a(t){var n=t.u;do{for(var r=n.properties.length;r--;){var e=n.properties[r];e.enabled&&(Jt[e.id]&&Jt[e.id]!==e&&(Jt[e.id].enabled=!1,delete Jt[e.id]),Jt[e.id]=e)}}while(n=n.next)}function h(t){var n=t.u;do{for(var r=n.properties.length;r--;)n.properties[r].refresh()}while(n=n.next)}function f(t,n,r){return V(t)&&V(n)&&V(r)?Qt:$.test(t)&&$.test(n)&&$.test(r)?Mt:Y(t)&&Y(n)&&Y(r)?Dt:V(t)&&Y(n)&&V(r)?Gt:zt}function c(t,n,r,e,i){this.id=t,this.name=n,this.target=r,this.origProps=e,this.targetProps=i,this.enabled=!0,this.length=0}function l(t){var n=t.u,r=0;do{for(var e=!1,i=n.properties.length;i--;){var o=n.properties[i];if(o.enabled&&o.type!==zt){switch(o.type){case Dt:for(var u=n.target[o.name],s=0;s<o.length;s++){var a=o.start[s],h=o.end[s]-a;u[s]=t.v(t.g,a,h)}break;case Qt:n.target[o.name]=t.v(t.g,o.start,o.end);break;case Gt:var f=o.waypoints.length-1,c=f*t.g,l=K.floor(c),p=t.v(c-l,o.waypoints[l],o.waypoints[l+1>f?f:l+1]);n.target[o.name]=p;break;case Mt:var v=t.g,d=t.v(v,o.colorStart[0],o.colorEnd[0]),m=t.v(v,o.colorStart[1],o.colorEnd[1]),l=t.v(v,o.colorStart[2],o.colorEnd[2]),g=(255*d<<16)+(255*m<<8)+(255*l|0);n.target[o.name]="#"+g.toString(16)}e=o.type!==zt}else n.properties.splice(i,1)}r+=0|e}while(n=n.next);return r}function p(t,n){if(0==t.k){t.w&&(t.w=!1,h(t),a(t)),t.e||(t.e=!0,t.a(t.t));l(t)>0?t.b(t.t):t.kill()}i(t),e(t,n)}function v(t,n,r){for(var e,i,o=Y(t.t)?t.t:[t.t],u=Object.keys(n),s=Object.keys(r),a=0;a<s.length;a++)n[s[a]]||u.push(s[a]);for(var h=o.length;h--;){var f=o[h];f.x=f.x||Vt++;for(var l=[],p=0;p<u.length;p++){var v=u[p];if(!t.hasOwnProperty(v)&&v in f){var d=new c(f.x+v,v,f,r,n);d.refresh(),l.push(d)}}var m={target:f,properties:l};i=i||m,e&&(e.next=m),e=m}t.u=i}function d(t){var n=Et.indexOf(t);n!==-1&&(Et.splice(n,1),t.y=!1)}function m(t){t.y||(v(t,t.z,t.A),Et.push(t),t.y=!0,t.w=!0,t.e=!1,u())}function g(t){if(Tt[t])return Tt[t];if(Y(t)&&4==t.length)return At(st.apply(this,t));if(void 0!=t){var n=Object.keys(Tt).join(" | ");console.warn("Invalid easing name: "+t),console.warn("Available easings: "+n)}return Tt.linear}function y(t,e,i){t.B=!1;var o=i.shift(),u=i.shift();Z(o)&&(u=o,o=0),t.t=e,t.y=!1,t.w=!0,t.v=g(u.ease),t.A=Z(u.from)?u.from:{},t.z=Z(u.to)?u.to:{},t.s=V(o)?K.max(0,o):0,t.B=!0,r(t,u),n(t,u)}function k(t){var n=t.shift();if(!("object"==typeof n&&t.length>0))throw"Invalid Tween";return y(this,n,t),this}function w(t){return function(){for(var n=Et.length;n--;){var r=Et[n];r[t].apply(r,arguments)}}}function b(t){for(var n=Et.length;n--;)Et[n].i||(Et[n].y=!1,Et.splice(n,1));for(var n=0,r=Et.length;n<r;n++)Et[n].q&&p(Et[n],t)}function I(){var t=rt(),n=!1;Ft.q&&(Ft.tick(t),n=!0);for(var r=Bt.length;r--;){var e=Bt[r];e.q&&(e.tick(t),n=!0),e.i||Bt.splice(r,1)}0===Et.length&&0===Bt.length&&(Ct=!0),n&&!Ct&&R(I)}function O(t){var n=new x(t);return Bt.push(n),u(),n}function x(t){t=t||{},this.C=J(t.onTick)?t.onTick:et,this.i=!0,this.setFPS(t.fps),this.resume()}function j(t){t?Ft.resume():Ft.pause()}function S(t){t="number"==typeof t?t:Ft.D,t<0&&(t=0),!Ft.q&&b(t)}function q(){return function(){for(var t=arguments.length,n=[];t--;)n[t]=arguments[t];var r=new k(n);return r.B&&m(r),r}}function P(t){return t instanceof k?Rt:V(t)?Nt:X(t)?Kt:J(t)?Ut:Y(t)?Ht:Z(t)?Lt:$t}function A(t,n){for(var r=!0,e=0;e<n.length;e++){var i=n[e],o=P(i);if(o==$t)r=!1;else if(o==Kt)r=void 0!==t[i];else if(o==Ht)r=A(t,i);else if(o==Lt)for(var u=Object.keys(i),s=0;s<u.length;s++){var a=u[s];if(!V(i[a])){r=!1;break}}if(!r){console.warn("Unknown label value:",i);break}}return r}function T(t,n,r,e){this.obj=t,this.type=n,this.start=r,this.end=e}function F(t,n){return X(n)?F(t,t[n]):n}function E(t,n){for(var r=!0,e=0;e<n.length;e++){var i=F(t,n[e]);if(X(i)){r=!1;break}Y(i)?n[e]=E(t,i):n[e]=i}return r||(n=E(t,n)),_(n)}function B(t){var n=ot(t,"start");if(n<0)for(var r=K.abs(n),e=0;e<t.length;e++)t[e].start+=r,t[e].end+=r;return t}function C(t){return ut(t,"end")-ot(t,"start")}function Q(t,n,r){r=r||0;var e=[],i=F(t,n);i=Y(i)?i:[i];for(var o=E(t,i),u=0;u<o.length;u++){var s=o[u],a=P(s);if(a==Nt)r+=s;else{var h=r,f=r;if(a==Rt&&(f=h+s.duration()),a==Lt){for(var c=Object.keys(s),l=[],p=0,v=0;v<c.length;v++){var d=c[v];p=K.min(p,s[d]);var m=s[d]+r;l=l.concat(Q(t,d,m))}e=e.concat(l),r+=C(l),r+=p<0?p:0}else e.push(new T(s,a,h,f)),r+=f-h}}return e}function D(t,e){t.B=!1,n(t,e),r(t,e),t.B=!0}function M(t){D(this,t),this.F={},this.G=[],this.H="",this.I=O({onTick:this.tick.bind(this)}),this.J||this.I.pause()}function G(t,n){if(0===t.k){t.e||(t.e=!0,t.a(t));for(var r=0;r<t.G.length;r++){var u=t.G[r];(1==t.f&&t.h>=u.start||t.f==-1&&t.h<=u.end)&&(u.type==Rt&&(o(u.obj,t.h-u.start,!0,!0),p(u.obj,0)),u.type==Ut&&u.obj.apply(t))}}i(t),e(t,n)}function z(t){return new M(t)}var R,U,H=window||{},L=H.performance,N={}.toString,K=Math,$=new RegExp(/(^#[0-9A-F]{6}$)|(^#[0-9A-F]{3}$)/i),J=t("function",!0),V=t("number",!0),W=t("boolean",!0),X=t("string",!0),Y=Array.isArray||t("[object Array]",!1),Z=function(t){return!!t&&t.constructor===Object},_=function(t){return[].concat.apply([],t)},tt=function(t){var n=parseInt(t.slice(1),16);return[(n>>16&255)/255,(n>>8&255)/255,(255&n)/255]},nt=function(t,n,r){return K.min(K.max(t,n),r)},rt=function(){return L&&L.now&&L.now()||+new Date},et=function(){return!1},it=function(t,n,r){return t.apply(K,n.map(function(t){return t[r]}))},ot=function(t,n){return it(K.min,t,n)},ut=function(t,n){return it(K.max,t,n)},st=function(){function t(t,n){return 1-3*n+3*t}function n(t,n){return 3*n-6*t}function r(t){return 3*t}function e(e,i,o){return((t(i,o)*e+n(i,o))*e+r(i))*e}function i(e,i,o){return 3*t(i,o)*e*e+2*n(i,o)*e+r(i)}function o(t,n,r,i,o){var u,s,f=0;do{s=n+(r-n)/2,u=e(s,i,o)-t,u>0?r=s:n=s}while(Math.abs(u)>a&&++f<h);return s}function u(t,n,r,o){for(var u=0;u<s;++u){var a=i(n,r,o);if(0===a)return n;n-=(e(n,r,o)-t)/a}return n}var s=4,a=1e-7,h=10,f=11,c=1/(f-1),l="function"==typeof Float32Array;return function(t,n,r,s){function a(n){for(var e=0,s=1,a=f-1;s!==a&&h[s]<=n;++s)e+=c;--s;var l=(n-h[s])/(h[s+1]-h[s]),p=e+l*c,v=i(p,t,r);return v>=.001?u(n,p,t,r):0===v?p:o(n,e,e+c,t,r)}if(!(0<=t&&t<=1&&0<=r&&r<=1))throw new Error("bezier x values must be in [0, 1] range");var h=l?new Float32Array(f):new Array(f);if(t!==n||r!==s)for(var p=0;p<f;++p)h[p]=e(p*c,t,r);return function(i){return t===n&&r===s?i:0===i?0:1===i?1:e(a(i),n,s)}}}(),at=function(t){return function(n){return K.pow(n,t)}},ht=function(t){return function(n){return 1-K.abs(K.pow(n-1,t))}},ft=function(t){return function(n){return n<.5?at(t)(2*n)/2:ht(t)(2*n-1)/2+.5}},ct=function(t){var n=1.70158;return t*t*((n+1)*t-n)},lt=function(t){var n=1.70158;return--t*t*((n+1)*t+n)+1},pt=function(t){var n=2.5949095;return(t*=2)<1?t*t*((n+1)*t-n)*.5:.5*((t-=2)*t*((n+1)*t+n)+2)},vt=function(t){return 1-dt(1-t)},dt=function(t){return t<1/2.75?7.5625*t*t:t<2/2.75?7.5625*(t-=1.5/2.75)*t+.75:t<2.5/2.75?7.5625*(t-=2.25/2.75)*t+.9375:7.5625*(t-=2.625/2.75)*t+.984375},mt=function(t){return t<.5?.5*vt(2*t):.5*dt(2*t-1)+.5},gt=function(t){return 0===t?0:1===t?1:-K.pow(2,10*(t-1))*K.sin(5*(t-1.1)*K.PI)},yt=function(t){return 0===t?0:1===t?1:K.pow(2,-10*t)*K.sin(5*(t-.1)*K.PI)+1},kt=function(t){return 0===t?0:1===t?1:(t*=2,t<1?-.5*K.pow(2,10*(t-1))*K.sin(5*(t-1.1)*K.PI):.5*K.pow(2,-10*(t-1))*K.sin(5*(t-1.1)*K.PI)+1)},wt=function(t){return 1-K.sqrt(1-t*t)},bt=function(t){return K.sqrt(1- --t*t)},It=function(t){return(t*=2)<1?-.5*(K.sqrt(1-t*t)-1):.5*(K.sqrt(1-(t-=2)*t)+1)},Ot=function(t){return 1-K.cos(t*K.PI/2)},xt=function(t){return K.sin(t*K.PI/2)},jt=function(t){return.5*(1-K.cos(K.PI*t))},St=function(t){return 0===t?0:K.pow(1024,t-1)},qt=function(t){return 1===t?1:1-K.pow(2,-10*t)},Pt=function(t){return 0===t?0:1===t?1:(t*=2)<1?.5*K.pow(1024,t-1):.5*(2-K.pow(2,-10*(t-1)))},At=function(t){return function(n,r,e){return r+t(n)*(e-r)}},Tt={linear:At(ft(1)),BackIn:At(ct),BackOut:At(lt),BackInOut:At(pt),BounceIn:At(vt),BounceOut:At(dt),BounceInOut:At(mt),CircIn:At(wt),CircOut:At(bt),CircInOut:At(It),CubicIn:At(at(3)),CubicOut:At(ht(3)),CubicInOut:At(ft(3)),ElasticIn:At(gt),ElasticOut:At(yt),ElasticInOut:At(kt),ExpoIn:At(St),ExpoOut:At(qt),ExpoInOut:At(Pt),QuadIn:At(at(2)),QuadOut:At(ht(2)),QuadInOut:At(ft(2)),QuartIn:At(at(4)),QuartOut:At(ht(4)),QuartInOut:At(ft(4)),QuintIn:At(at(5)),QuintOut:At(ht(5)),QuintInOut:At(ft(5)),SineIn:At(Ot),SineOut:At(xt),SineInOut:At(jt)};!function(){var t,n,r,e,i,o,u,s,a=0;t=["ms","moz","webkit","o"],n="AnimationFrame",r="request"+n,e="cancel"+n,R=H[r],U=H[e];for(var i=t.lenght;!R&&i--;)R=H[t[i]+"Request"+n],U=H[t[i]+"Cancel"+n];R=R||function(t){return o=rt(),u=K.max(0,16-(o-a)),s=setTimeout(function(){t(o+u)},u),a=o+u,s},U=U||function(t){clearTimeout(t)}}();var Ft,Et=[],Bt=[],Ct=!0,Qt=0,Dt=1,Mt=2,Gt=3,zt=4,Rt=0,Ut=1,Ht=2,Lt=3,Nt=4,Kt=5,$t=6,Jt={},Vt=1;c.prototype={K:function(t,n){for(var r=this.target[this.name],e=K.max(t.length,n.length),i=0;i<e;i++)t[i]=void 0!=t[i]?t[i]:r[i],n[i]=void 0!=n[i]?n[i]:r[i];this.length=e},refresh:function(){this.start=this.origProps[this.name],void 0===this.start&&(this.start=this.target[this.name]),this.end=this.targetProps[this.name],void 0===this.end&&(this.end=this.target[this.name]),this.type=f(this.start,this.end,this.target[this.name]),this.type==Dt?this.K(this.start,this.end):this.type==Gt?this.waypoints=[this.start].concat(this.end):this.type==Mt&&(this.colorStart=tt(this.start),this.colorEnd=tt(this.end))}},k.prototype={delay:function(t){return this.k=this.j=t,this},progress:function(t,n){return o(this,t,n,!1),this},time:function(t,n){return o(this,t,n,!0),this},render:function(){a(this),l(this)},restart:function(t,n){return t=!!W(t)&&t,n=!W(n)||n,this.h=0,this.g=0,this.k=t?this.j:0,this.i=!0,this.f=1,this.e=!1,this.resume(),(n||this.k>0)&&this.render(),this},reverse:function(){return this.f*=-1,this},timeScale:function(t){return V(t)&&t>0&&(this.p=t),this},kill:function(){if(arguments.length>0){for(var t=[],n=0;n<arguments.length;++n)t[n]=arguments[n];s(this,t)}else this.i=!1,this.q=!1;return this},pause:function(){return this.q=!1,this},resume:function(){return this.q=!0,m(this),this},stop:function(){return d(this),this},duration:function(){var t=this.p,n=this.s/t;if(this.m>1){var r=(this.m-1)*this.o;n=n*this.m+r/t}return n+this.j/t},toString:function(){return"[object Tween]"}},x.prototype={pause:function(){return this.q=!1,this},resume:function(){return this.L=rt(),this.q=!0,R(I),this},kill:function(){return this.i=!1,this},tick:function(t){var n=t-this.L;if(n>this.D){var r=n%this.D;this.L=t-r,this.C(K.min(n-r,2*this.D)/1e3)}return this},setFPS:function(t){this.fps=V(t)&&t>0?t:60,this.D=1e3/this.fps},toString:function(){return"[object Ticker]"}},M.prototype={M:function(t){if(this.N){t=t||this.H;var n=Q(this.F,t);this.G=B(n),this.s=C(this.G),this.N=!1}},let:function(t,n){var r=P(n);if(X(t)&&r!=$t){if((r==Ht||r==Lt)&&!A(this.F,n))return this;r==Rt&&n.stop(),this.F[t]=n,this.N=!0}return this},tick:function(t){return this.M(),G(this,t),this.i||this.I.kill(),this},delay:function(t){return this.j=V(t)?t:0,this},plot:function(t){return"undefined"!=typeof plotTimeline&&plotTimeline(this,t),this},reverse:function(){return this.f*=-1,this},yoyo:function(t){return this.l=!!W(t)&&t,this},duration:function(){return this.M(),this.s},timeScale:function(t){this.p=V(t)?K.max(0,t):1},seek:function(t,n){return this.M(),o(this,t,n,!0),this.tick(0),this},progress:function(t,n){return this.M(),o(this,t,n,!1),this.tick(0),this},pause:function(){return this.I.pause(),this},resume:function(){return this.I.resume(),this},restart:function(t){return this.k=t?this.j:0,this},play:function(t){return this.H=t,this.I.resume(),this},kill:function(){return this.I.kill(),this}},Ft=new x({onTick:b});var Wt=new function(){};return function(t,n,r){for(var e in n)(r||!(e in t))&&(t[e]=n[e]);return t}(Wt,{set:q(),tween:q(),killAll:w("kill"),killTweensOf:function(){console.log("todo")},pauseAll:w("pause"),resumeAll:w("resume"),timeline:z,ticker:O,update:S,autoUpdate:j,setFPS:Ft.setFPS.bind(Ft)})});