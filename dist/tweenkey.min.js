!function(t,n){"function"==typeof define&&define.amd?define([],n):"object"==typeof module&&module.exports?module.exports=t.Tweenkey=n():t.Tweenkey=n()}(this,function(){"use strict";function t(t,n){return function(e){return n?typeof e===t:$.call(e)===t}}function n(t,n){var e=n||{};t.a=Y(e.onStart)?e.onStart:at,t.b=Y(e.onUpdate)?e.onUpdate:at,t.c=Y(e.onComplete)?e.onComplete:at,t.d=Y(e.onRepeat)?e.onRepeat:at}function e(t,n){var e=n||{},r=Z(e.delay)?W.max(0,e.delay):0,i=Z(e.repeat)?e.repeat:0;t.e=0,t.f=!!tt(e.reversed)&&e.reversed,t.g=t.f?-1:1,t.h=0,t.i=0,t.j=0,t.k=0,t.l=!0,t.m=r,t.n=r,t.o=!!tt(e.yoyo)&&e.yoyo,t.p=t.o?i>0?i:-1:i,t.q=t.p,t.r=Z(e.repeatDelay)?W.max(0,e.repeatDelay):0,t.s=Z(e.timeScale)&&e.timeScale>0?e.timeScale:1,t.t=!tt(e.autoStart)||e.autoStart,t.u=e}function r(t,n){var e=n*t.s;if(e>0){a(t,(W.max(0,t.j-t.m)+e)/t.e,!0,!1)}}function i(t){0===t.k&&t.j>0&&t.a.call(t.v||t)}function o(t){1===t.i&&t.k!==t.e&&t.c.call(t,t.v)}function s(t){if(t.j>0&&t.p>0||t.o){var n=t.w+t.r,e=t.j/n,r=t.k/n,i=~r-~e,o=e>r?r:e;0!==i&&W.abs(o)<t.p&&t.d.call(t,t.v)}}function u(t){1===t.i&&t.kill()}function a(t,n,e,r){var i=t.w,o=t.e;if(r){var s=t.m,u=0;e?(u=s/(s+o),n=(n-u)/u/o):(u=s/(s+i),n=(n-u)/u),t.n=W.max(0,t.n-t.j)}else t.n=0;if(n=st(n,0,1),n=n,e){t.i=n;var a=o*n%(i+1e-4);t.h=a/i}else t.h=n,t.i=n*i/o;t.k=t.j,t.j=o*t.i,t.h=t.h,t.i=t.i,console.log("local:",t.h,"global:",t.i,"elapsed time:",t.j)}function c(){setTimeout(function(){Dt=!1,P()},1)}function f(t,n){var e=!et(n),r=t.x;do{for(var i=r.properties.length;i--;){var o=r.properties[i];o.enabled&&(e||n.indexOf(o.name)>-1)&&(o.enabled=!1,delete Yt[o.id])}}while(r=r.next)}function h(t){var n=t.x;do{for(var e=n.properties.length;e--;){var r=n.properties[e];r.enabled&&(Yt[r.id]&&Yt[r.id]!==r&&(Yt[r.id].enabled=!1,delete Yt[r.id]),Yt[r.id]=r)}}while(n=n.next)}function l(t){var n=t.x;do{for(var e=n.properties.length;e--;)n.properties[e].refresh()}while(n=n.next)}function p(t,n,e){return Z(t)&&Z(n)&&Z(e)?Ht:X.test(t)&&X.test(n)&&X.test(e)?Kt:et(t)&&et(n)&&et(e)?Mt:Z(t)&&et(n)&&Z(e)?Nt:Jt}function v(t,n,e,r,i){this.id=t,this.name=n,this.target=e,this.origProps=r,this.targetProps=i,this.enabled=!0,this.length=0}function d(t){if(t.o&&t.j>0){var n=t.w,e=t.e;return W.ceil(e*t.i/n)%2==0?1-t.h:t.h}return t.h}function m(t){var n=t.x,e=0;do{for(var r=d(t),i=!1,o=n.properties.length;o--;){var s=n.properties[o];if(s.enabled&&s.type!==Jt){switch(s.type){case Mt:for(var u=n.target[s.name],a=0;a<s.length;a++){var c=s.start[a],f=s.end[a]-c;u[a]=t.y(r,c,f)}break;case Ht:n.target[s.name]=t.y(r,s.start,s.end);break;case Nt:var h=s.waypoints.length-1,l=h*r,p=W.floor(l),v=t.y(l-p,s.waypoints[p],s.waypoints[p+1>h?h:p+1]);n.target[s.name]=v;break;case Kt:var m=t.y(r,s.colorStart[0],s.colorEnd[0]),g=t.y(r,s.colorStart[1],s.colorEnd[1]),p=t.y(r,s.colorStart[2],s.colorEnd[2]),y=(255*m<<16)+(255*g<<8)+(255*p|0);n.target[s.name]="#"+y.toString(16)}i=s.type!==Jt}else n.properties.splice(o,1)}e+=0|i}while(n=n.next);return e}function g(t,n){if(i(t),t.j>0){t.z&&(t.z=!1,l(t),h(t));m(t)>0?t.b.call(t.v):t.kill()}else m(t);s(t),o(t),u(t),r(t,n)}function y(t,n,e){for(var r,i,o=et(t.v)?t.v:[t.v],s=Object.keys(n),u=Object.keys(e),a=0;a<u.length;a++)n[u[a]]||s.push(u[a]);for(var c=o.length;c--;){var f=o[c];f.A=f.A||Zt++;for(var h=[],l=0;l<s.length;l++){var p=s[l];if(!t.hasOwnProperty(p)&&p in f){var d=new v(f.A+p,p,f,e,n);d.refresh(),h.push(d)}}var m={target:f,properties:h};i=i||m,r&&(r.next=m),r=m}t.x=i}function w(t){var n=qt.indexOf(t);n!==-1&&(qt.splice(n,1),t.B=!1)}function k(t){t.B||(y(t,t.C,t.D),qt.push(t),t.B=!0,t.z=!0,c())}function b(t){if(Rt[t])return Rt[t];if(et(t)&&4==t.length)return Ct(lt.apply(this,t));if(void 0!=t){var n=Object.keys(Rt).join(" | ");console.warn("Invalid easing name: "+t),console.warn("Available easings: "+n)}return Rt.linear}function O(t){if(t.o===!0&&t.p===-1)t.e=2*t.w;else if(t.p>0){var n=t.w,e=n;n+=e*t.p,t.e=n}else t.e=t.w}function I(t,r,i){t.F=!1;var o=i.shift(),s=i.shift();rt(o)&&(s=o,o=0),t.v=r,t.B=!1,t.z=!0,t.y=b(s.ease),t.D=rt(s.from)?s.from:{},t.C=rt(s.to)?s.to:{},t.w=Z(o)?W.max(0,o):0,t.F=!0,e(t,s),n(t,s),O(t)}function x(t){var n=t.shift();if(!("object"==typeof n&&t.length>0))throw"Invalid Tween";return I(this,n,t),this}function j(t){return function(){for(var n=qt.length;n--;){var e=qt[n];e[t].apply(e,arguments)}}}function S(t){for(var n=qt.length;n--;)qt[n].l||(qt[n].B=!1,qt.splice(n,1));for(var n=0,e=qt.length;n<e;n++)qt[n].t&&g(qt[n],t)}function P(){var t=ut(),n=!1;Ut.t&&(Ut.tick(t),n=!0);for(var e=zt.length;e--;){var r=zt[e];r.t&&(r.tick(t),n=!0),r.l||zt.splice(e,1)}0===qt.length&&0===zt.length&&(Dt=!0),n&&!Dt&&L(P)}function T(t){var n=new A(t);return zt.push(n),c(),n}function A(t){t=t||{},this.G=Y(t.onTick)?t.onTick:at,this.l=!0,this.setFPS(t.fps),this.resume()}function F(t){t?Ut.resume():Ut.pause()}function E(t){t="number"==typeof t?t:Ut.H,t<0&&(t=0),!Ut.t&&S(t)}function Q(){return function(){for(var t=arguments.length,n=[];t--;)n[t]=arguments[t];var e=new x(n);return e.F&&k(e),e}}function B(t){return t instanceof x?Lt:Z(t)?$t:nt(t)?Wt:Y(t)?Vt:et(t)?_t:rt(t)?Gt:Xt}function C(t,n){for(var e=!0,r=0;r<n.length;r++){var i=n[r],o=B(i);if(o==Xt)e=!1;else if(o==Wt)e=void 0!==t[i];else if(o==_t)e=C(t,i);else if(o==Gt)for(var s=Object.keys(i),u=0;u<s.length;u++){var a=s[u];if(!Z(i[a])){e=!1;break}}if(!e){console.warn("Unknown label value:",i);break}}return e}function R(t,n,e,r){this.I=t,this.J=n,this.K=e,this.L=r,this.M=!0}function U(t,n){return nt(n)?U(t,t[n]):n}function q(t,n){for(var e=!0,r=0;r<n.length;r++){var i=U(t,n[r]);if(nt(i)){e=!1;break}et(i)?n[r]=q(t,i):n[r]=i}return e||(n=q(t,n)),it(n)}function z(t){var n=ft(t,"_start");if(n<0)for(var e=W.abs(n),r=0;r<t.length;r++)t[r].K+=e,t[r].L+=e;return t}function D(t){return ht(t,"_end")-ft(t,"_start")}function H(t,n,e){e=e||0;var r=[],i=U(t,n);i=et(i)?i:[i];for(var o=q(t,i),s=0;s<o.length;s++){var u=o[s],a=B(u);if(a==$t)e+=u;else{var c=e,f=e;if(a==Lt&&(f=c+u.e),a==Gt){for(var h=Object.keys(u),l=[],p=0,v=0;v<h.length;v++){var d=h[v];p=W.min(p,u[d]);var m=u[d]+e;l=l.concat(H(t,d,m))}r=r.concat(l),e+=D(l),e+=p<0?p:0}else r.push(new R(u,a,c,f)),e+=f-c}}return r}function M(t,r){t.F=!1,n(t,r),e(t,r),t.F=!0}function K(t){M(this,t),this.N={},this.O=[],this.P=this.g,this.k=0,this.Q="",this.R=T({onTick:this.tick.bind(this)}),this.R.pause()}function N(t,n){if(0===t.n){i(t);for(var e=0;e<t.O.length;e++){var s=t.O[e];(1==t.g&&t.j>=s.K||t.g==-1&&t.j<=s.L)&&(s.J==Lt?(a(s.I,t.j-s.K),g(s.I,0)):s.J==Vt&&s.M&&(s.I.apply(t),s.M=!1))}}o(t),u(t),r(t,n)}function J(t){return new K(t)}var L,V,_=window||{},G=_.performance,$={}.toString,W=Math,X=new RegExp(/(^#[0-9A-F]{6}$)|(^#[0-9A-F]{3}$)/i),Y=t("function",!0),Z=t("number",!0),tt=t("boolean",!0),nt=t("string",!0),et=Array.isArray||t("[object Array]",!1),rt=function(t){return!!t&&t.constructor===Object},it=function(t){return[].concat.apply([],t)},ot=function(t){var n=parseInt(t.slice(1),16);return[(n>>16&255)/255,(n>>8&255)/255,(255&n)/255]},st=function(t,n,e){return W.min(W.max(t,n),e)},ut=function(){return G&&G.now&&G.now()||+new Date},at=function(){return!1},ct=function(t,n,e){return t.apply(W,n.map(function(t){return t[e]}))},ft=function(t,n){return ct(W.min,t,n)},ht=function(t,n){return ct(W.max,t,n)},lt=function(){function t(t,n){return 1-3*n+3*t}function n(t,n){return 3*n-6*t}function e(t){return 3*t}function r(r,i,o){return((t(i,o)*r+n(i,o))*r+e(i))*r}function i(r,i,o){return 3*t(i,o)*r*r+2*n(i,o)*r+e(i)}function o(t,n,e,i,o){var s,u,f=0;do{u=n+(e-n)/2,s=r(u,i,o)-t,s>0?e=u:n=u}while(Math.abs(s)>a&&++f<c);return u}function s(t,n,e,o){for(var s=0;s<u;++s){var a=i(n,e,o);if(0===a)return n;n-=(r(n,e,o)-t)/a}return n}var u=4,a=1e-7,c=10,f=11,h=1/(f-1),l="function"==typeof Float32Array;return function(t,n,e,u){function a(n){for(var r=0,u=1,a=f-1;u!==a&&c[u]<=n;++u)r+=h;--u;var l=(n-c[u])/(c[u+1]-c[u]),p=r+l*h,v=i(p,t,e);return v>=.001?s(n,p,t,e):0===v?p:o(n,r,r+h,t,e)}if(!(0<=t&&t<=1&&0<=e&&e<=1))throw new Error("bezier x values must be in [0, 1] range");var c=l?new Float32Array(f):new Array(f);if(t!==n||e!==u)for(var p=0;p<f;++p)c[p]=r(p*h,t,e);return function(i){return t===n&&e===u?i:0===i?0:1===i?1:r(a(i),n,u)}}}(),pt=function(t){return function(n){return W.pow(n,t)}},vt=function(t){return function(n){return 1-W.abs(W.pow(n-1,t))}},dt=function(t){return function(n){return n<.5?pt(t)(2*n)/2:vt(t)(2*n-1)/2+.5}},mt=function(t){var n=1.70158;return t*t*((n+1)*t-n)},gt=function(t){var n=1.70158;return--t*t*((n+1)*t+n)+1},yt=function(t){var n=2.5949095;return(t*=2)<1?t*t*((n+1)*t-n)*.5:.5*((t-=2)*t*((n+1)*t+n)+2)},wt=function(t){return 1-kt(1-t)},kt=function(t){return t<1/2.75?7.5625*t*t:t<2/2.75?7.5625*(t-=1.5/2.75)*t+.75:t<2.5/2.75?7.5625*(t-=2.25/2.75)*t+.9375:7.5625*(t-=2.625/2.75)*t+.984375},bt=function(t){return t<.5?.5*wt(2*t):.5*kt(2*t-1)+.5},Ot=function(t){return 0===t?0:1===t?1:-W.pow(2,10*(t-1))*W.sin(5*(t-1.1)*W.PI)},It=function(t){return 0===t?0:1===t?1:W.pow(2,-10*t)*W.sin(5*(t-.1)*W.PI)+1},xt=function(t){return 0===t?0:1===t?1:(t*=2,t<1?-.5*W.pow(2,10*(t-1))*W.sin(5*(t-1.1)*W.PI):.5*W.pow(2,-10*(t-1))*W.sin(5*(t-1.1)*W.PI)+1)},jt=function(t){return 1-W.sqrt(1-t*t)},St=function(t){return W.sqrt(1- --t*t)},Pt=function(t){return(t*=2)<1?-.5*(W.sqrt(1-t*t)-1):.5*(W.sqrt(1-(t-=2)*t)+1)},Tt=function(t){return 1-W.cos(t*W.PI/2)},At=function(t){return W.sin(t*W.PI/2)},Ft=function(t){return.5*(1-W.cos(W.PI*t))},Et=function(t){return 0===t?0:W.pow(1024,t-1)},Qt=function(t){return 1===t?1:1-W.pow(2,-10*t)},Bt=function(t){return 0===t?0:1===t?1:(t*=2)<1?.5*W.pow(1024,t-1):.5*(2-W.pow(2,-10*(t-1)))},Ct=function(t){return function(n,e,r){return e+t(n)*(r-e)}},Rt={linear:Ct(dt(1)),BackIn:Ct(mt),BackOut:Ct(gt),BackInOut:Ct(yt),BounceIn:Ct(wt),BounceOut:Ct(kt),BounceInOut:Ct(bt),CircIn:Ct(jt),CircOut:Ct(St),CircInOut:Ct(Pt),CubicIn:Ct(pt(3)),CubicOut:Ct(vt(3)),CubicInOut:Ct(dt(3)),ElasticIn:Ct(Ot),ElasticOut:Ct(It),ElasticInOut:Ct(xt),ExpoIn:Ct(Et),ExpoOut:Ct(Qt),ExpoInOut:Ct(Bt),QuadIn:Ct(pt(2)),QuadOut:Ct(vt(2)),QuadInOut:Ct(dt(2)),QuartIn:Ct(pt(4)),QuartOut:Ct(vt(4)),QuartInOut:Ct(dt(4)),QuintIn:Ct(pt(5)),QuintOut:Ct(vt(5)),QuintInOut:Ct(dt(5)),SineIn:Ct(Tt),SineOut:Ct(At),SineInOut:Ct(Ft)};!function(){var t,n,e,r,i,o,s,u,a=0;t=["ms","moz","webkit","o"],n="AnimationFrame",e="request"+n,r="cancel"+n,L=_[e],V=_[r];for(var i=t.lenght;!L&&i--;)L=_[t[i]+"Request"+n],V=_[t[i]+"Cancel"+n];L=L||function(t){return o=ut(),s=W.max(0,16-(o-a)),u=setTimeout(function(){t(o+s)},s),a=o+s,u},V=V||function(t){clearTimeout(t)}}();var Ut,qt=[],zt=[],Dt=!0,Ht=0,Mt=1,Kt=2,Nt=3,Jt=4,Lt=0,Vt=1,_t=2,Gt=3,$t=4,Wt=5,Xt=6,Yt={},Zt=1;v.prototype={S:function(t,n){for(var e=this.target[this.name],r=W.max(t.length,n.length),i=0;i<r;i++)t[i]=void 0!=t[i]?t[i]:e[i],n[i]=void 0!=n[i]?n[i]:e[i];this.length=r},refresh:function(){this.start=this.origProps[this.name],void 0===this.start&&(this.start=this.target[this.name]),this.end=this.targetProps[this.name],void 0===this.end&&(this.end=this.target[this.name]),this.type=p(this.start,this.end,this.target[this.name]),this.type==Mt?this.S(this.start,this.end):this.type==Nt?this.waypoints=[this.start].concat(this.end):this.type==Kt&&(this.colorStart=ot(this.start),this.colorEnd=ot(this.end))}},x.prototype={delay:function(t){return this.n=this.m=t,this},progress:function(t,n){return a(this,t,!1,n),g(this,0),this},totalProgress:function(t,n){return a(this,t,!0,n),g(this,0),this},time:function(t,n){return a(this,t,n,!0),this},render:function(){h(this),m(this)},restart:function(t,n){return t=!!tt(t)&&t,n=!tt(n)||n,this.j=0,this.h=0,this.n=t?this.m:0,this.l=!0,this.g=1,this.resume(),(n||this.n>0)&&this.render(),this},reverse:function(){return this.g*=-1,this},timeScale:function(t){return Z(t)&&t>0&&(this.s=t),this},kill:function(){if(arguments.length>0){for(var t=[],n=0;n<arguments.length;++n)t[n]=arguments[n];f(this,t)}else this.l=!1,this.t=!1;return this},pause:function(){return this.t=!1,this},resume:function(){return this.t=!0,k(this),this},stop:function(){return w(this),this},toString:function(){return"[object Tween]"}},A.prototype={pause:function(){return this.t=!1,this},resume:function(){return this.T=ut(),this.t=!0,L(P),this},kill:function(){return this.l=!1,this},tick:function(t){var n=t-this.T;if(n>this.H){var e=n%this.H;this.T=t-e,this.G(W.min(n-e,2*this.H)/1e3)}return this},setFPS:function(t){this.fps=Z(t)&&t>0?t:60,this.H=1e3/this.fps},toString:function(){return"[object Ticker]"}},K.prototype={U:function(t){if(this.V){t=t||this.Q;var n=H(this.N,t);this.O=z(n),this.e=D(this.O),console.log(this.e),this.V=!1}},let:function(t,n){var e=B(n);if(nt(t)&&e!=Xt){if((e==_t||e==Gt)&&!C(this.N,n))return this;e==Lt&&n.stop(),this.N[t]=n,this.V=!0}return this},tick:function(t){return this.U(),N(this,t),this.l||this.R.kill(),this},delay:function(t){return this.m=Z(t)?t:0,this},plot:function(t){return"undefined"!=typeof plotTimeline&&plotTimeline(this,t),this},reverse:function(){return this.g*=-1,this},yoyo:function(t){return this.o=!!tt(t)&&t,this},duration:function(){return this.U(),this.e},timeScale:function(t){this.s=Z(t)?W.max(0,t):1},seek:function(t,n){return this.U(),a(this,t,n,!0),this.tick(0),this},progress:function(t,n){return this.U(),a(this,t,n,!1),this.tick(0),this},pause:function(){return this.R.pause(),this},resume:function(){return this.R.resume(),this},restart:function(t){return this.n=t?this.m:0,this},play:function(t){return this.Q=t,this.R.resume(),this},kill:function(){return this.R.kill(),this}},Ut=new A({onTick:S});var tn=new function(){};return function(t,n,e){for(var r in n)(e||!(r in t))&&(t[r]=n[r]);return t}(tn,{set:Q(),tween:Q(),killAll:j("kill"),killTweensOf:function(){console.log("todo")},pauseAll:j("pause"),resumeAll:j("resume"),timeline:J,ticker:T,update:E,autoUpdate:F,setFPS:Ut.setFPS.bind(Ut)})});